# the colums we want to retrieve directly
attri = c("anno_min",
"mese_min",
"giorno_min",
"area"),
# tables to join the description
joins = list(
"tbl_frane.Generalita.Cod_tipo" = c(
"diz_frane.diz_tipo_movi.cod_tipo",
"diz_frane.diz_tipo_movi.tipologia"
),
"tbl_frane.clas_ii_liv.movimento" = c(
"diz_frane.diz_movimenti.movimento",
"diz_frane.diz_movimenti.nome_movimento"
),
"tbl_frane.Geologia.litologia" = c(
"diz_frane.diz_litologie.litologia",
"diz_frane.diz_litologie.nome_litologia"
)
)
)
usethis::use_data(landsld)
usethis::use_data(landsld, compress = "xz")
usethis::use_data(landsld, compress = "xz", overwrite = T)
library(iffitoR)
landsld
class(landsld)
devtools::load_all()
?landsld
library(iffitoR)
?landsld
?example_data
?landsld
devtools::load_all()
file.edit("NAMESPACE")
devtools::document()
?landsld
file.edit("data_raw/sample_data.R")
file.edit("R/example_data.R")
file.edit("R/make_shapefile.R")
res
unique(res$nome_movimento)
unique(res$tipologia)
#' funtion to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "fall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex")
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Espansione", replacement="expansion"),
tipologia = str_replace(tipologia, pattern="Espansione", replacement="expansion")
)
return(res)
}
res = translate(res)
unique(res$nome_movimento)
#' funtion to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "fall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex")
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Espansione", replacement="expansion"),
tipologia = str_replace(tipologia, pattern="Espansione", replacement="expansion")
)
return(df)
}
res = translate(res)
unique(res$nome_movimento)
res
a = iffitoR::res
unique(a$nome_movimento)
unique(a$tipologia)
unique(a$nome_movimento)
unique(a$tipologia)
#' function to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = "Colamento lento", replacement = "flow (slow)"),
nome_movimento = str_replace(nome_movimento, pattern = "Colamento rapido", replacement = "flow (fast)"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
return(df)
}
res
df = translate(res)
unique(df$nome_movimento)
unique(res$nome_movimento)
#' function to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*lento", replacement = "flow (slow)"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*rapido", replacement = "flow (fast)"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
return(df)
}
df = translate(res)
unique(df$nome_movimento)
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*lento", replacement = "slow flow"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*rapido", replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
df = translate(res)
unique(df$nome_movimento)
#' function to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*lento", replacement = "slow flow"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*rapido", replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
return(df)
}
df = translate(res)
unique(df$nome_movimento)
#' function to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = "col.*lento", replacement = "slow flow"),
nome_movimento = str_replace_all(nome_movimento, pattern = "col.*rapido", replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
return(df)
}
df = translate(res)
unique(df$nome_movimento)
b = res$nome_movimento
str_replace(n, "col.*lento", "slow flow")
str_replace_all(n, "col.*lento", "slow flow")
b
class(b)
str_replace_all(b, "col.*lento", "slow flow")
str_replace_all(b, "col", "slow flow")
unique(b)
b[[9]]
b[[8]]
b[9]
b
unique(b)[[]]
unique(b)[[9]]
a = unique(b)
a
str_replace_all(a, "col.*lento\\", "slow flow")
str_replace_all(a, "col.*lento\", "slow flow")
str_replace_all(a, "col.*lento\\\\", "slow flow")
str_replace_all(a, "col.*lento\"", "slow flow")
#' function to translate some of the column to english
#'
#' @export
#'
translate = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = 'col.*lento"', replacement = "slow flow"),
nome_movimento = str_replace_all(nome_movimento, pattern = 'col.*rapido"', replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
)
return(df)
}
df = translate(res)
unique(df$nome_movimento)
unique(res$tipologia)
unique(df$tipologia)
devtools::document()
file.edit("NAMESPACE")
devtools::document()
file.edit("R/translate.R")
#' function to translate some of the column to english
#'
#' @export
#'
translate_iffi = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = 'col.*lento"', replacement = "slow flow"),
nome_movimento = str_replace_all(nome_movimento, pattern = 'col.*rapido"', replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
) %>%
# rename the actual variables
mutate(
first_level = tipologia,
second_level = nome_movimento
)
return(df)
}
df = translate(res)
names(df)
#' function to translate some of the column to english
#'
#' @export
#'
translate_iffi = function(df) {
df = df %>%
# rename the values in nome_movimento
mutate(
nome_movimento = str_replace(nome_movimento, pattern = "[Cc]omplesso", replacement = "complex"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a crolli/ribaltamenti diffusi", replacement = "area of rockfall/topple"),
nome_movimento = str_replace(nome_movimento, pattern = "crollo", replacement = "rockfall"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento traslativo", replacement = "translational"),
nome_movimento = str_replace(nome_movimento, pattern = "scivolamento rotazionale", replacement = "rotational"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "areas prone to sinking"),
nome_movimento = str_replace(nome_movimento, pattern = 'col.*lento"', replacement = "slow flow"),
nome_movimento = str_replace_all(nome_movimento, pattern = 'col.*rapido"', replacement = "fast flow"),
nome_movimento = str_replace(nome_movimento, pattern = "ribalmento", replacement = "overturn"),
nome_movimento = str_replace(nome_movimento, pattern = "DGPV", replacement = "deep seated landslide"),
nome_movimento = str_replace(nome_movimento, pattern = "Sprofondamento", replacement = "subsidence"),
nome_movimento = str_replace(nome_movimento, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
nome_movimento = str_replace(nome_movimento, pattern = "espansione", replacement = "expansion"),
) %>%
# rename the values in tipologia
mutate(
tipologia = str_replace(tipologia, pattern="Complesso", replacement="complex"),
tipologia = str_replace(tipologia, pattern="Aree soggette a crolli/ribaltamenti diffusi", replacement="area of rockfall/topple"),
tipologia = str_replace(tipologia, pattern="Crollo/Ribaltamento", replacement="rockfall"),
tipologia = str_replace(tipologia, pattern="Scivolamento rotazionale/traslativo", replacement="translational/rotational slide"),
tipologia = str_replace(tipologia, pattern = "Espansione", replacement = "expansion"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a frane superficiali diffuse", replacement = "area of diffuse surface slides"),
tipologia = str_replace(tipologia, pattern = "Colamento lento", replacement = "flow (slow)"),
tipologia = str_replace(tipologia, pattern = "Colamento rapido", replacement = "flow (fast)"),
tipologia = str_replace(tipologia, pattern = "DGPV", replacement = "deep seated landslide"),
tipologia = str_replace(tipologia, pattern = "Sprofondamento", replacement = "subsidence"),
tipologia = str_replace(tipologia, pattern = "Aree soggette a sprofondamenti diffusi", replacement = "area of diffuse subsidence")
) %>%
# rename the actual variables
mutate(
first_level = tipologia,
second_level = nome_movimento
)
return(df)
}
df = translate_iffi(res)
names(df)
df %>% count(first_level, sort=T)
devtools::document()
file.edit("data_raw/sample_data.R")
library(iffitoR)
library(sf)
library(RODBC)
library(dplyr)
library(stringr)
# define some paths
database_dir = "../euracR/data/database/"
shape_path = "../euracR/data/Shapefiles/IFFI10_1.shp"
# query the data
landsld = make_shapefile(
database_dir = database_dir,
# normally null only setting it here for me
attribute_database_name = "tbl_frane",
# the name without extension
dictionary_database_name = "diz_frane",
shapefile = shape_path,
# the colums we want to retrieve directly
attri = c("anno_min",
"mese_min",
"giorno_min",
"area"),
# tables to join the description
joins = list(
"tbl_frane.Generalita.Cod_tipo" = c(
"diz_frane.diz_tipo_movi.cod_tipo",
"diz_frane.diz_tipo_movi.tipologia"
),
"tbl_frane.clas_ii_liv.movimento" = c(
"diz_frane.diz_movimenti.movimento",
"diz_frane.diz_movimenti.nome_movimento"
),
"tbl_frane.Geologia.litologia" = c(
"diz_frane.diz_litologie.litologia",
"diz_frane.diz_litologie.nome_litologia"
)
)
)
# rename the dataframe
landsld = iffitoR::translate_iffi(landsld)
usethis::use_data(landsld, compress = "xz", overwrite = T)
file.edit("R/example_data.R")
devtools
devtools::document()
